---
path: "/rails"
date: "2020-03-16"
title: "Symbols in Ruby"
---

參考資料：
Ruby 手冊： https://ruby-doc.org/core-2.7.0/Symbol.html

老師著作：為你自己學 Ruby on Rails

---

許久沒有動筆寫寫有架構的文章，在程式老師們強力推薦下 Rocketgirl's blog 終於動工啦，期待她一天一天茁壯成為水噹噹的姑娘。

---

今天第一篇文章主題： Ruby 中的「**`:symbol`符號**」究竟是啥東東呢？

恐怕談符號前得先淺談一下變數和字串：

### 變數 variable

- 命名通常混用英文字母、數字或底線，ex.  
  `rocket_100 = "mars"` <br> `year = 2020`<br>

  即 變數(名) `rocket_100/ year` 指向 `=` 字串`mars` 或值`2020` <br>

- 變數就是指向某個物件的「名字」

* 補充：一個`=`代表指向(assign)，兩個`==`代表檢查是否為相同物件(ture or false, ex. `1 == 1.0 #=>ture`)

### 字串 string

- string 這個英文單字其中一個解釋是量詞，代表一串物體 （object），像是：一串念珠、一串珍珠；  
  程式世界中也代表著一串字母（物體 object)，尤其字串可以用`[]`替換指定字母，所以也可以想成有一串字母的陣列，是不是相當有趣呢
- Ruby 字串定義：包在 double quotes 或 single quote 中的文字，ex. `"我是字串"`, `'我也是字串'`

- `""`可以用 `%Q` 取代，`''`可以用 %q 取代  
  （使用時機：例如當字串中剛好有 I'm，除了用 `I\'m` 處理，也可以直接在小括號使用`%q`）
- `""` `%Q`有 string Interpolation 字串安插 `#{}`的功能；詳情於介紹字串方法時再談
- 補充：空白字元(space)不算空字串唷

### 符號 :symbol

- 為何文章中每次提到符號的英文就會加上`:`冒號呢，因為 Ruby 中字串定義非常簡單，只要在任何英文單字前加上`:`就形成一個符號了，ex. `:sunday`、`:Sunday`  
  程式世界中大小寫或任何字元的差異，都代表不同的物件
- `:symbol` 不像上述的「變數」必須指向(assign)一個字串或值才有意義；符號就是「有名字的物件」可以直接拿來用
- `:symbol`也可看做一種「不可變(immutable)的字串」
- 抽象的符號，在程式世界中和數字的概念頗為相似，例如：
  數字和符號都不能當變數，所以  
  **_可以_**
  `symbol變數 =指向 :symbol 符號`或`symbol = 100`<br>
  **_不可以_** `:ooo = 'xxx' or :plus = 100`

### :符號與"字串"之比較

- `.object_id`：<br>
  符號會保持相同的`.object_id`，固定佔住一小個記憶體空間；雖然 Ruby 已修正大量符號拖垮記憶體的問題，但若使用非常多符號仍會拖慢效能；僅在符號使用量少的狀況下，效能才會比字串快(因為少量使用時，符號有固定記憶體位置，回饋效能快)

  相反的，字串每次都有不同 object_id，代表記憶體每次用完就釋放出來

- 雖然可以把符號當字串用(`.to_s`或字串轉符號`to_sym`)，但符號類別內建方法不如字串類別豐富
- 如果只是想在畫面上印出內容，仍然建議選用字串，因為符號輸出時，仍然會先轉型成字串，所以效能又差了一點點

---

### hash 散列

- 這裡提到**散列資料形式**是因為散列需要固定一個 key 對一個 value，如同一組鎖與鑰匙，而 key 通常使用:symbol；雖然任何物件都可以當 key，但是拿取資料時變數和方法易造成混淆，所以非常適合使用符號
- hash 寫法：

```ruby
# 1_箭頭式
{:title => "Ruby", :price => 350}
# 2_類json:
{title: "Ruby", price: 350 }

:title和:price都是key, "Ruby"和350則是value
```
